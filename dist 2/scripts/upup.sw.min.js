Cache.prototype.add||(Cache.prototype.add=function(t){return this.addAll([t])}),Cache.prototype.addAll||(Cache.prototype.addAll=function(t){function e(t){this.name="NetworkError",this.code=19,this.message=t}var n=this;return e.prototype=Object.create(Error.prototype),Promise.resolve().then(function(){if(arguments.length<1)throw new TypeError;return t=t.map(function(t){return t instanceof Request?t:String(t)}),Promise.all(t.map(function(t){"string"==typeof t&&(t=new Request(t));var n=new URL(t.url).protocol;if("http:"!==n&&"https:"!==n)throw new e("Invalid scheme");return fetch(t.clone())}))}).then(function(e){return Promise.all(e.map(function(e,r){return n.put(t[r],e)}))}).then(function(){})}),CacheStorage.prototype.match||(CacheStorage.prototype.match=function(t,e){var n=this;return this.keys().then(function(r){var o;return r.reduce(function(r,c){return r.then(function(){return o||n.open(c).then(function(n){return n.match(t,e)}).then(function(t){return o=t})})},Promise.resolve())})});var _CACHE_NAME="upup-cache";self.addEventListener("message",function(t){"set-settings"===t.data.action&&_setSettings(t.data.settings)}),self.addEventListener("fetch",function(t){t.respondWith(fetch(t.request.url,{mode:"no-cors"})["catch"](function(){return caches.match(t.request).then(function(e){return e?e:t.request.headers.get("accept").includes("text/html")?caches.match("sw-offline-content"):void 0})}))});var _setSettings=function(t){return caches.open(_CACHE_NAME).then(function(e){return t.assets&&e.addAll(t.assets.map(function(t){return new Request(t,{mode:"no-cors"})})),t["content-url"]?fetch(t["content-url"],{mode:"no-cors"}).then(function(t){return e.put("sw-offline-content",t)}):t.content?e.put("sw-offline-content",_buildResponse(t.content)):e.put("sw-offline-content",_buildResponse("You are offline"))})},_buildResponse=function(t){return new Response(t,{headers:{"Content-Type":"text/html"}})};
//# sourceMappingURL=upup.sw.min.js.map
